import numpy as np

default_energy = 0.0

energies = {'ILE': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391, 'CD1': 0.019177, 'CG1': 0.019177, 'CG2': 0.019177},
            'GLN': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'CD': 0.019177, 'N': -0.0391, 'NE2': -0.0391, 'OE1': -0.03128},
            'GLY': {'C': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391,},
            'GLU': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'CD': 0.019177, 'OE2': -0.06877, 'N': -0.0391, 'OE1': -0.06877},
            'CYS': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391, 'SG': 0.02576},
            'CYX': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391, 'SG': 0.00506},
            'ASP': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'N': -0.0391, 'OD1': -0.06877, 'OD2': -0.06877},
            'SER': {'C': 0.019177, 'OG': -0.04255, 'CB': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391,},
            'LYS': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'CE': 0.019177, 'CD': 0.019177, 'NZ': -0.12604, 'O': -0.03128, 'N': -0.0391},
            'PRO': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'CD': 0.019177, 'N': -0.0391},
            'HIS': {'C': 0.019177, 'CE1': 0.110176, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CD2': 0.110176, 'ND1': -0.0391, 'NE2': -0.0391},
            'HID': {'C': 0.019177, 'CE1': 0.110176, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CD2': 0.110176, 'ND1': -0.06279, 'NE2': -0.0391},
            'HIE': {'C': 0.019177, 'CE1': 0.110176, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CD2': 0.110176, 'ND1': -0.0391, 'NE2': -0.06279},
            'ASN': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'N': -0.0391, 'OD1': -0.03128, 'ND2': -0.0391},
            'VAL': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'O': -0.03128, 'N': -0.0391, 'CG1': 0.019177, 'CG2': 0.019177},
            'THR': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'OG1': -0.04255, 'O': -0.03128, 'N': -0.0391, 'CG2': 0.019177},
            'TRP': {'C': 0.019177, 'CZ2': 0.110176, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'CH2': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CE2': 0.110176, 'CE3': 0.110176, 'CD1': 0.110176, 'CD2': 0.110176, 'CZ3': 0.110176, 'NE1': -0.0391},
            'PHE': {'C': 0.019177, 'CE1': 0.110176, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CZ': 0.110176, 'CD1': 0.110176, 'CD2': 0.110176, 'CE2': 0.110176},
            'ALA': {'CB': 0.019177, 'CA': 0.019177, 'C': 0.019177, 'O': -0.03128, 'N': -0.0391},
            'MET': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'CE': 0.019177, 'N': -0.0391, 'O': -0.03128, 'SD': 0.00506},
            'AHP': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'CE': 0.019177, 'CD': 0.019177, 'CZ': 0.019177, 'O': -0.03128, 'N': -0.0391},
            'LEU': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'N': -0.0391, 'CD1': 0.019177, 'CD2': 0.019177},
            'ARG': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'NE': -0.0391, 'O': -0.03128, 'CD': 0.019177, 'CZ': 0.019177, 'NH1': -0.06279, 'NH2': -0.06279, 'N': -0.0391},
            'AHX': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'CE': 0.019177, 'CD': 0.019177, 'O': -0.03128, 'N': -0.0391,},
            'TYR': {'C': 0.019177, 'CE1': 0.110176, 'OH': -0.04255, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.110176, 'O': -0.03128, 'N': -0.0391, 'CZ': 0.110176, 'CD1': 0.110176, 'CD2': 0.110176, 'CE2': 0.110176}, 
            'APE': {'C': 0.019177, 'CB': 0.019177, 'CA': 0.019177, 'CG': 0.019177, 'O': -0.03128, 'CD': 0.019177, 'N': -0.0391}}


def get_solvation(protein):
    """Get the solvation score for a given molecule"""
    energy_per_atom = []
    for atom in protein.atoms:
        if not atom.is_hydrogen():
            residue_name = atom.residue_name
            atom_name = atom.name

            # Special cases
            if atom_name == "OXT":
                residue_name = "ASP"
                atom_name = "OD1"
            if residue_name == 'HSD':
                residue_name = 'HID'
            if residue_name == 'HSP':
                residue_name = 'HIP'
            if residue_name == 'HSE':
                residue_name = 'HIE'
            if residue_name == 'HID':
                residue_name = 'HIP'
            try:
                energy_per_atom.append(energies[residue_name][atom_name])
            except KeyError:
                energy_per_atom.append(default_energy)
        else:
            energy_per_atom.append(default_energy)

    return np.array(energy_per_atom)
